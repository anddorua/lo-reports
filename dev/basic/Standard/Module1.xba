<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="Module1" script:language="StarBasic">REM  *****  BASIC  *****

Sub Main

End Sub

sub starter( _
	optional byval reportName as string, _
	optional byval reportDir as string, _
	optional byval dataDir as string, _
	optional byval dstDir as string)
	
	if ismissing(reportName) then
	  reportName = &quot;&quot;
	endif
	if ismissing(reportDir) then
	  reportDir = &quot;&quot;
	endif
	if ismissing(dataDir) then
	  dataDir = &quot;&quot;
	endif
	if ismissing(dstDir) then
	  dstDir = &quot;&quot;
	endif
	
	dim msg as new com.sun.star.logging.LogRecord
	msg.Message = a
	msg.Level = com.sun.star.logging.LogLevel.ALL
	
	dim obj as object
	obj = createUnoService(&quot;com.sun.star.logging.ConsoleHandler&quot;)
	obj.initialize(Array())
	obj.Level = com.sun.star.logging.LogLevel.ALL

	msg.Message = reportName
	msg.Level = com.sun.star.logging.LogLevel.ALL
	obj.publish(msg)

	msg.Message = reportDir
	msg.Level = com.sun.star.logging.LogLevel.ALL
	obj.publish(msg)

	msg.Message = dataDir
	msg.Level = com.sun.star.logging.LogLevel.ALL
	obj.publish(msg)

	msg.Message = dstDir
	msg.Level = com.sun.star.logging.LogLevel.ALL
	obj.publish(msg)
end sub

sub starter2( _
	optional byval reportName as string, _
	optional byval reportDir as string, _
	optional byval dataDir as string, _
	optional byval dstDir as string)
	
	if ismissing(reportName) then
	  reportName = &quot;&quot;
	endif
	if ismissing(reportDir) then
	  reportDir = &quot;&quot;
	endif
	if ismissing(dataDir) then
	  dataDir = &quot;&quot;
	endif
	if ismissing(dstDir) then
	  dstDir = &quot;&quot;
	endif
	
	dim msg as new com.sun.star.logging.LogRecord
	msg.Message = a
	msg.Level = com.sun.star.logging.LogLevel.ALL
	
	dim obj as object
	obj = createUnoService(&quot;com.sun.star.logging.ConsoleHandler&quot;)
	obj.initialize(Array())
	obj.Level = com.sun.star.logging.LogLevel.ALL

	msg.Message = reportName
	msg.Level = com.sun.star.logging.LogLevel.ALL
	obj.publish(msg)

	msg.Message = reportDir
	msg.Level = com.sun.star.logging.LogLevel.ALL
	obj.publish(msg)

	msg.Message = dataDir
	msg.Level = com.sun.star.logging.LogLevel.ALL
	obj.publish(msg)

	msg.Message = dstDir
	msg.Level = com.sun.star.logging.LogLevel.ALL
	obj.publish(msg)

	dim ds as Object
	set ds = new DataSource
	ds._dataDir = &quot;/home/application/reports&quot;
	ds._workDir = &quot;/home/application/reports&quot;
	ds.CollectData
	ds.CloseCollector
end sub

function show_open_dialog
	dim aurl as object
	dim s as string
	dim oDlg as object
	
	oDlg = createUnoService(&quot;com.sun.star.ui.dialogs.FilePicker&quot;)
	oDlg.setMultiSelectionMode(false)
	oDlg.appendFilter(&quot;CSV Files (.csv)&quot;, &quot;*.csv&quot; )	
	oDlg.execute
	aUrl = oDlg.getFiles()
	
	s = aUrl(0)
	if len(s) &gt; 0 then
		MsgBox(&quot;File Selected: &quot; &amp; s &amp; chr(13))
	end if
	show_open_dialog = s
end function

sub testDataSource
	dim ds as Object
	dim cell as object
	set ds = new DataSource
	ds._dataDir = &quot;/home/andriy/projects/lo-reports/dev/reports&quot;
	ds._workDir = &quot;/home/andriy/tmp&quot;
	ds.CollectData
	cell = ds.GetCell(&quot;persons&quot;, &quot;Count&quot;, 17)
	if not isnull(cell) then
		print cell.string
	else
		print &quot;null&quot;
	endif
	ds.CloseCollector
end sub

sub testReportMaker
	dim rm as New ReportMaker
	dim res as boolean
	res = rm.Make( _
		&quot;/home/andriy/projects/lo-reports/dev/reports/report1.ods&quot;, _
		&quot;/home/andriy/projects/lo-reports/dev/reports/test2.xls&quot;, _
		nothing)
	if res then
		print &quot;success&quot;
	else
		print rm._error
	endif
end sub


sub copy_area
rem ----------------------------------------------------------------------
rem define variables
dim document   as object
dim dispatcher as object
rem ----------------------------------------------------------------------
rem get access to the document
document   = ThisComponent.CurrentController.Frame
dispatcher = createUnoService(&quot;com.sun.star.frame.DispatchHelper&quot;)

rem ----------------------------------------------------------------------
dim args1(0) as new com.sun.star.beans.PropertyValue
args1(0).Name = &quot;ToPoint&quot;
args1(0).Value = &quot;$B$5:$E$5&quot;

dispatcher.executeDispatch(document, &quot;.uno:GoToCell&quot;, &quot;&quot;, 0, args1())

rem ----------------------------------------------------------------------
dispatcher.executeDispatch(document, &quot;.uno:Copy&quot;, &quot;&quot;, 0, Array())

rem ----------------------------------------------------------------------
dim args3(0) as new com.sun.star.beans.PropertyValue
args3(0).Name = &quot;Nr&quot;
args3(0).Value = 2

dispatcher.executeDispatch(document, &quot;.uno:JumpToTable&quot;, &quot;&quot;, 0, args3())

rem ----------------------------------------------------------------------
dim args4(0) as new com.sun.star.beans.PropertyValue
args4(0).Name = &quot;ToPoint&quot;
args4(0).Value = &quot;$B$12&quot;

dispatcher.executeDispatch(document, &quot;.uno:GoToCell&quot;, &quot;&quot;, 0, args4())

rem ----------------------------------------------------------------------
dim args5(0) as new com.sun.star.beans.PropertyValue
args5(0).Name = &quot;ToPoint&quot;
args5(0).Value = &quot;$C$13&quot;

dispatcher.executeDispatch(document, &quot;.uno:GoToCell&quot;, &quot;&quot;, 0, args5())

rem ----------------------------------------------------------------------
dim args6(0) as new com.sun.star.beans.PropertyValue
args6(0).Name = &quot;ToPoint&quot;
args6(0).Value = &quot;$C$12&quot;

dispatcher.executeDispatch(document, &quot;.uno:GoToCell&quot;, &quot;&quot;, 0, args6())

rem ----------------------------------------------------------------------
dispatcher.executeDispatch(document, &quot;.uno:Paste&quot;, &quot;&quot;, 0, Array())


end sub
</script:module>